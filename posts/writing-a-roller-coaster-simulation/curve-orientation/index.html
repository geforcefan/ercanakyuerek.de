<!doctype html><html lang=en><head><meta charset=UTF-8><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content><meta name=description content="In earlier chapters, we already computed basic orientations along the track, and for a while that worked reasonably well. The trouble starts when we rely too much on a simple lookAt from THREE.js together with a fixed-up direction.
The missing piece here is roll, also known as rotation around the forward direction.
Whenever we use lookAt, we must provide an up vector. So far, this has always been Vector3(0, 1, 0). This is fine for gentle slopes, but it starts to fall apart when the track approaches angles close to 90 degrees.
"><meta name=keywords content="homepage,blog,writing a roller coaster simulation"><meta name=robots content="noodp"><meta name=theme-color content><link rel=canonical href=https://ercanakyuerek.de/posts/writing-a-roller-coaster-simulation/curve-orientation/><title>Curve orientation :: Ercan Akyürek</title><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css integrity="sha512-Cv93isQdFwaKBV+Z4X8kaVBYWHST58Xb/jVOcV9aRsGSArZsgAnFIhMpDoMDcFNoUtday1hdjn0nGp3+KZyyFw==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=/main.14b819624c3fc7cddd32f4d8dedcfbbc021742fa0527e486d77d85772220b4ec.css integrity="sha256-FLgZYkw/x83dMvTY3tz7vAIXQvoFJ+SG132FdyIgtOw="><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color><link rel="shortcut icon" href=/favicon.ico><meta name=msapplication-TileColor content><meta itemprop=name content="Curve orientation"><meta itemprop=description content="In earlier chapters, we already computed basic orientations along the track, and for a while that worked reasonably well. The trouble starts when we rely too much on a simple lookAt from THREE.js together with a fixed-up direction.
The missing piece here is roll, also known as rotation around the forward direction.
Whenever we use lookAt, we must provide an up vector. So far, this has always been Vector3(0, 1, 0). This is fine for gentle slopes, but it starts to fall apart when the track approaches angles close to 90 degrees."><meta itemprop=datePublished content="2026-01-04T14:30:00+01:00"><meta itemprop=dateModified content="2026-01-04T14:30:00+01:00"><meta itemprop=wordCount content="1450"><meta itemprop=keywords content="Writing a Roller Coaster Simulation"><meta name=twitter:card content="summary"><meta name=twitter:title content="Curve orientation"><meta name=twitter:description content="In earlier chapters, we already computed basic orientations along the track, and for a while that worked reasonably well. The trouble starts when we rely too much on a simple lookAt from THREE.js together with a fixed-up direction.
The missing piece here is roll, also known as rotation around the forward direction.
Whenever we use lookAt, we must provide an up vector. So far, this has always been Vector3(0, 1, 0). This is fine for gentle slopes, but it starts to fall apart when the track approaches angles close to 90 degrees."><meta property="og:url" content="https://ercanakyuerek.de/posts/writing-a-roller-coaster-simulation/curve-orientation/"><meta property="og:site_name" content="Ercan Akyürek"><meta property="og:title" content="Curve orientation"><meta property="og:description" content="In earlier chapters, we already computed basic orientations along the track, and for a while that worked reasonably well. The trouble starts when we rely too much on a simple lookAt from THREE.js together with a fixed-up direction.
The missing piece here is roll, also known as rotation around the forward direction.
Whenever we use lookAt, we must provide an up vector. So far, this has always been Vector3(0, 1, 0). This is fine for gentle slopes, but it starts to fall apart when the track approaches angles close to 90 degrees."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2026-01-04T14:30:00+01:00"><meta property="article:modified_time" content="2026-01-04T14:30:00+01:00"><meta property="article:tag" content="Writing a Roller Coaster Simulation"><meta property="article:published_time" content="2026-01-04 14:30:00 +0100 +0100"><script async src="https://www.googletagmanager.com/gtag/js?id=G-WCX2MRFT7Z"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-WCX2MRFT7Z")}</script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js></script><script>MathJax={tex:{displayMath:[["\\[","\\]"],["$$","$$"]],inlineMath:[["\\(","\\)"]]},loader:{load:["ui/safe"]}}</script></head><body><div class=container><header class=header><span class=header__inner><a href=/ style=text-decoration:none><div class=logo><span class=logo__mark>></span>
<span class=logo__text>ercanakyuerek.de</span>
<span class=logo__cursor></span></div></a><span class=header__right><nav class=menu><ul class=menu__inner><li><a href=/about>About me</a></li><li><a href=/posts>Posts</a></li></ul></nav><span class=menu-trigger><svg viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span></span></span></header><div class=content><main class=post><div class=post-info><p><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
7 minutes</p></div><article><h1 class=post-title><a href=https://ercanakyuerek.de/posts/writing-a-roller-coaster-simulation/curve-orientation/>Curve orientation</a></h1><div class=post-content><p>In earlier chapters, we already computed basic orientations along the
track, and for a while that worked reasonably well. The trouble starts
when we rely too much on a simple <code>lookAt</code> from <strong>THREE.js</strong> together
with a <strong>fixed-up direction</strong>.</p><p>The missing piece here is <strong>roll</strong>, also known as rotation around the
<strong>forward direction</strong>.</p><p>Whenever we use <code>lookAt</code>, we must provide an <strong>up vector</strong>. So far,
this has always been <code>Vector3(0, 1, 0)</code>. This is fine for <strong>gentle
slopes</strong>, but it starts to fall apart when the track approaches angles
close to <strong>90 degrees</strong>.</p><p>At that point, the <strong>curve direction</strong> points almost straight up. The
<strong>up vector</strong> also points up. Now both vectors look into the sky, and
the resulting <strong>matrix</strong> becomes unstable.</p><p>When the track points straight up, <strong>roll</strong> is no longer uniquely
defined. Rotating around that direction does not change where the
track is pointing, so <code>lookAt</code> has no stable orientation to choose
from.</p><p>Mathematically, this happens because <code>lookAt</code> constructs an
orientation using <strong>cross-products</strong>. When the <strong>forward direction</strong>
becomes parallel, or nearly parallel, to the <strong>up vector</strong>, the
cross-product between them approaches zero. Once that happens, the
remaining axes of the <strong>matrix</strong> cannot be built reliably anymore.</p><p>The visible result is <strong>sudden flips</strong>, <strong>jitter</strong>, or <strong>strange
twisting</strong> along the track, especially around slopes <strong>close to 90
degrees</strong>.</p><h1 id=incremental-orientation>Incremental orientation</h1><p>To fix this, we need a slightly different approach. Instead of
computing each orientation in isolation, we build it
<strong>incrementally</strong>. We start from the transformation <strong>matrix</strong> of the
<strong>previous node</strong> and apply a small rotation that follows the <strong>curve
direction</strong>.</p><p>In other words, we still align the orientation with the curve, but we
do it <strong>relative to the previous node’s orientation</strong>, instead of
rebuilding everything from scratch.</p><p>This way, the <strong>up direction</strong> is not reset at every step. It slowly
rotates along the curve, preserving the existing <strong>roll</strong> instead of
fighting against it.</p><p>This technique is commonly called <strong>parallel transport</strong>, because the
orientation is transported along the curve with <strong>as little rotation
as possible</strong>.</p><p>Think of it like this: we add rotation step by step while respecting
the <strong>previous orientation</strong>.</p><p>The following interactive demo lets us switch between a <strong>fixed-up
lookAt orientation</strong> and an <strong>incremental orientation based on the
previous node</strong>. This helps visualize the problem.</p><div class=embedded><iframe id=react-root-1971d7792bd506b20b19be0dc90716cc width=100% height=700px class=frame></iframe><div class=description style=width:100%><strong>fixed-up lookAt orientation</strong>: Roll becomes unstable near 90° slopes. <strong>Incremental rotation</strong>: Stable roll and smooth orientation along the curve.</div><script>document.getElementById("react-root-1971d7792bd506b20b19be0dc90716cc").srcdoc=`
    <!DOCTYPE html>
    <html lang="en" data-theme="dark">
      <head>
          <base href="${location.origin}/">
      </head>
        <body class="content-component">
        <div id="root" class="full-screen"></div>
        <script type="module">
          import { renderContentComponentByPath } from '/scripts/render-content-component.js';
          renderContentComponentByPath('root', './posts/writing-a-roller-coaster-simulation/curve-orientation/LookAtExampleScene.tsx');
        <\/script>
      </body>
    </html>
  `</script></div><h2 id=parallel-transport>Parallel transport</h2><p>Now we can look at how to actually solve the <strong>fixed-up <code>lookAt</code>
problem</strong>.</p><p>We already know the key idea: instead of rebuilding the orientation at
every node, we rotate <strong>incrementally</strong>, relative to the <strong>previous
node</strong>.</p><p>For each <strong>curve node step</strong>, we compute a <strong>transported frame</strong> and
return a new transformation <strong>matrix</strong>.</p><p>The steps are:</p><ul><li>Compute the <strong>direction</strong> towards the <strong>next curve node</strong> from the
<strong>current position</strong>.</li><li>Extract the <strong>current rotation</strong> from the transformation <strong>matrix</strong>.</li><li>Transform the direction using the <strong>current local rotation</strong> so it
is expressed relative to the <strong>orientation of the current node</strong>.</li><li>Apply <strong>yaw and pitch</strong> derived from the <strong>relative direction</strong> to
the transformation <strong>matrix</strong>. The <strong>relative direction itself</strong>
represents the <strong>increment</strong>.</li></ul><p>The result is a function that <strong>parallel-transports</strong> a transformation
<strong>matrix</strong> and returns a new, transported transformation <strong>matrix</strong>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>parallelTransportTransformation</span> <span style=color:#f92672>=</span> (
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>transformation</span>: <span style=color:#66d9ef>Matrix4</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>nextPosition</span>: <span style=color:#66d9ef>Vector3</span>,
</span></span><span style=display:flex><span>) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>position</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>toPosition</span>(<span style=color:#a6e22e>transformation</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>direction</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>position</span>.<span style=color:#a6e22e>clone</span>().<span style=color:#a6e22e>sub</span>(<span style=color:#a6e22e>nextPosition</span>).<span style=color:#a6e22e>normalize</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>rotationMatrix</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>toRotationMatrix</span>(<span style=color:#a6e22e>transformation</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>localRotation</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Matrix4</span>().<span style=color:#a6e22e>copy</span>(<span style=color:#a6e22e>rotationMatrix</span>).<span style=color:#a6e22e>invert</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>relativeDirection</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>direction</span>
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>clone</span>()
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>applyMatrix4</span>(<span style=color:#a6e22e>localRotation</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>relativeDirectionLength</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Vector2</span>(
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>relativeDirection</span>.<span style=color:#a6e22e>x</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>relativeDirection</span>.<span style=color:#a6e22e>z</span>,
</span></span><span style=display:flex><span>  ).<span style=color:#a6e22e>length</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>rotationY</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Matrix4</span>().<span style=color:#a6e22e>makeRotationY</span>(
</span></span><span style=display:flex><span>    Math.<span style=color:#a6e22e>atan2</span>(<span style=color:#f92672>-</span><span style=color:#a6e22e>relativeDirection</span>.<span style=color:#a6e22e>x</span>, <span style=color:#f92672>-</span><span style=color:#a6e22e>relativeDirection</span>.<span style=color:#a6e22e>z</span>),
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>rotationX</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Matrix4</span>().<span style=color:#a6e22e>makeRotationX</span>(
</span></span><span style=display:flex><span>    Math.<span style=color:#a6e22e>atan2</span>(<span style=color:#a6e22e>relativeDirection</span>.<span style=color:#a6e22e>y</span>, <span style=color:#a6e22e>relativeDirectionLength</span>),
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rotationMatrix</span>.<span style=color:#a6e22e>multiply</span>(<span style=color:#a6e22e>rotationY</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rotationMatrix</span>.<span style=color:#a6e22e>multiply</span>(<span style=color:#a6e22e>rotationX</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>rotationMatrix</span>.<span style=color:#a6e22e>setPosition</span>(<span style=color:#a6e22e>position</span>);
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><p>We also need a small helper that extracts a <strong>rotation matrix</strong> from a
transformation <strong>matrix</strong>. This assumes there is <strong>no scale</strong>
involved. Since we never use scale for <strong>curve transformation
matrices</strong>, this simplification is acceptable and keeps things simple.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>toRotationMatrix</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>transformation</span>: <span style=color:#66d9ef>Matrix4</span>) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>transformation</span>.<span style=color:#a6e22e>clone</span>().<span style=color:#a6e22e>setPosition</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><h2 id=constructing-a-curve-properly>Constructing a curve properly</h2><p>Now that we can <strong>parallel-transport</strong> a transformation <strong>matrix</strong>, we
need to actually use it.</p><p>In earlier chapters, we built curves using a <strong>temporary helper</strong> that
simply connected points without caring about <strong>orientation</strong>. Now is
the point where we finally remove it.</p><p>We introduce two new methods:</p><ul><li><code>insertTransformationMatrix</code>, which inserts a transformation
<strong>matrix</strong> into the curve and <strong>calculates arc length</strong> and updates
<strong>segment offsets</strong>.</li><li><code>insertPosition</code>, which inserts a <strong>position</strong> and computes the
correct <strong>orientation</strong> using <strong>parallel transport</strong>.</li></ul><p>We start with <code>insertTransformationMatrix</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>insertTransformationMatrix</span> <span style=color:#f92672>=</span> (
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>curve</span>: <span style=color:#66d9ef>Curve</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>transformation</span>: <span style=color:#66d9ef>Matrix4</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>segmentIndex</span>: <span style=color:#66d9ef>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>lastNode</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>last</span>(<span style=color:#a6e22e>curve</span>.<span style=color:#a6e22e>nodes</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>arcLength</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>lastNode</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>distanceToLastNode</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>distance</span>(
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>lastNode</span>.<span style=color:#a6e22e>transformation</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>transformation</span>,
</span></span><span style=display:flex><span>    );
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>distanceToLastNode</span> <span style=color:#f92672>&lt;</span> Number.<span style=color:#a6e22e>EPSILON</span>) <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>arcLength</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>lastNode</span>.<span style=color:#a6e22e>arcLength</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>distanceToLastNode</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>curve</span>.<span style=color:#a6e22e>segmentOffsets</span>[<span style=color:#a6e22e>segmentIndex</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>arcLength</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>curve</span>.<span style=color:#a6e22e>nodes</span>.<span style=color:#a6e22e>push</span>({
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>arcLength</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>transformation</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>segmentIndex</span>,
</span></span><span style=display:flex><span>  });
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><p>What happens here is fairly straightforward:</p><ul><li>We look up the <strong>last node’s position</strong> and compute the <strong>distance</strong>
to the new <strong>matrix</strong>.</li><li>We add that distance to the node’s <strong>arc length</strong>.</li><li>If the distance is <strong>zero</strong>, we skip inserting the node.</li><li>We compute the <strong>segment index</strong> and update the <strong>segment offset
list</strong> accordingly.</li></ul><blockquote><p><strong>Note:</strong> <strong>Segment offsets</strong> are a fast lookup structure for
segment lengths. For example, offsets like <code>[0, 20, 30]</code> tell us
that <strong>segment 1</strong> spans arc lengths from <strong>20 to 30</strong>. This will
become useful later.</p></blockquote><p>Next, we implement <code>insertPosition</code>, which handles the <strong>parallel
transport logic</strong>. The approach is as follows:</p><ul><li>The <strong>first point</strong> is added with an <strong>empty transformation matrix</strong>
that only contains a <strong>position</strong>.</li><li>Once we have at least one node, we treat the <strong>last node</strong> as the
<strong>left side</strong> and the new position as the <strong>right side</strong>.</li><li>If the <strong>distance</strong> between them is <strong>zero</strong>, we skip the insertion.</li><li>We parallel-transport the <strong>left transformation matrix</strong> toward the
<strong>right position</strong>.</li><li>The <strong>very first node</strong> needs to be transported <strong>twice</strong> to
initialize its <strong>orientation</strong>.</li><li>The <strong>last node</strong> always keeps the same <strong>orientation</strong> as its
predecessor, since there is <strong>no next point</strong> to define a direction.</li></ul><p>This is easier to understand once you look at the implementation:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>insertPosition</span> <span style=color:#f92672>=</span> (
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>curve</span>: <span style=color:#66d9ef>Curve</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>position</span>: <span style=color:#66d9ef>Vector3</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>segmentIndex</span>: <span style=color:#66d9ef>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>lastNode</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>last</span>(<span style=color:#a6e22e>curve</span>.<span style=color:#a6e22e>nodes</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>lastNode</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>insertTransformationMatrix</span>(
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>curve</span>,
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Matrix4</span>().<span style=color:#a6e22e>setPosition</span>(<span style=color:#a6e22e>position</span>),
</span></span><span style=display:flex><span>    );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>position</span>.<span style=color:#a6e22e>distanceTo</span>(<span style=color:#a6e22e>toPosition</span>(<span style=color:#a6e22e>lastNode</span>.<span style=color:#a6e22e>transformation</span>)) <span style=color:#f92672>&lt;</span>
</span></span><span style=display:flex><span>    Number.<span style=color:#a6e22e>EPSILON</span>
</span></span><span style=display:flex><span>  )
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>curve</span>.<span style=color:#a6e22e>nodes</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>1</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>lastNode</span>.<span style=color:#a6e22e>transformation</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>parallelTransportTransformation</span>(
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>lastNode</span>.<span style=color:#a6e22e>transformation</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>position</span>,
</span></span><span style=display:flex><span>    );
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>lastNode</span>.<span style=color:#a6e22e>transformation</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>parallelTransportTransformation</span>(
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>lastNode</span>.<span style=color:#a6e22e>transformation</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>position</span>,
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>insertTransformationMatrix</span>(
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>curve</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>lastNode</span>.<span style=color:#a6e22e>transformation</span>.<span style=color:#a6e22e>clone</span>().<span style=color:#a6e22e>setPosition</span>(<span style=color:#a6e22e>position</span>),
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>segmentIndex</span>,
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><p>With that in place, we can now update <code>bezierSplineCurve</code>. In earlier
chapters, this function relied on a temporary <code>fromPoints</code> helper with
<strong>no proper orientation</strong>. We can now replace that with repeated calls
to <code>insertPosition</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>bezierSplineCurve</span> <span style=color:#f92672>=</span> (
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>points</span>: <span style=color:#66d9ef>Vector3</span>[],
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>resolution</span>: <span style=color:#66d9ef>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>20</span>,
</span></span><span style=display:flex><span>) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>curve</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>emptyCurve</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>uniformSample</span>(
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>estimateTotalArcLength</span>(<span style=color:#a6e22e>points</span>),
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>resolution</span>,
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>at</span>, <span style=color:#a6e22e>t</span>) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>insertPosition</span>(<span style=color:#a6e22e>curve</span>, <span style=color:#a6e22e>deCasteljau</span>(<span style=color:#a6e22e>points</span>, <span style=color:#a6e22e>t</span>));
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>curve</span>;
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><h1 id=what-comes-next>What comes next?</h1><p>At this point, we finally have a <strong>stable orientation</strong> along the
curve, without <strong>jitter</strong> near <strong>steep slopes</strong>. It would be tempting
to go straight into a proper <strong>roll interpolation</strong>, but before doing
that, we want to take a step back.</p><p>The next step will be the introduction of <strong>NURBS curves</strong>, which
allow much more freedom than <strong>Bézier curves</strong> and make
experimentation far more interesting.</p><p>The theory behind this, like <strong>continuity</strong>, <strong>knot vectors</strong>, and
<strong>curve order</strong>, can get confusing quickly. For now, we keep the
implementation <strong>practical</strong> and leave most of the theory for a
separate <strong>spline-focused series</strong>.</p><p>If you want an introduction in the meantime, the video
<a href="https://www.youtube.com/watch?v=jvPPXbo87ds">The Continuity of Splines</a>
by <a href=https://www.youtube.com/@acegikmo>Ferya Holmèr</a> is <strong>gold</strong>. It
is <strong>perfect</strong> and covers almost everything you need to understand
<strong>splines in general</strong>.</p><h1 id=interactive-demo>Interactive demo</h1><p>This chapter ends with a small interactive example. You can move the
control points of a <strong>Bézier curve</strong> and observe how the
<strong>orientation</strong> behaves. There should be <strong>no sudden flips or jitter</strong>
near <strong>90 degree slopes</strong>.</p><div class=embedded><iframe id=react-root-427a99d78a89ab7e031b9c1d5364f6d9 width=100% height=650px class=frame></iframe>
<script>document.getElementById("react-root-427a99d78a89ab7e031b9c1d5364f6d9").srcdoc=`
    <!DOCTYPE html>
    <html lang="en" data-theme="dark">
      <head>
          <base href="${location.origin}/">
      </head>
        <body class="content-component">
        <div id="root" class="full-screen"></div>
        <script type="module">
          import { renderContentComponentByPath } from '/scripts/render-content-component.js';
          renderContentComponentByPath('root', './posts/writing-a-roller-coaster-simulation/curve-orientation/CurveOrientationDemoScene.tsx');
        <\/script>
      </body>
    </html>
  `</script></div><h1 id=demo-code>Demo code</h1><p>If you want to run the code locally, clone this
<a href=https://github.com/geforcefan/ercanakyuerek.de target=_blank>repository</a>,
run <code>npm install</code> and <code>npm run dev-scripts</code>,
then open this
<a href=http://localhost:3000/src/content/posts/writing-a-roller-coaster-simulation/curve-orientation/CurveOrientationDemoScene.tsx target=_blank>link</a>
in your browser.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-tsx data-lang=tsx><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>React</span>, { <span style=color:#a6e22e>useMemo</span>, <span style=color:#a6e22e>useState</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;react&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Line</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@react-three/drei&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Vector3</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;three&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>bezierSplineCurve</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;../../../../maths/bezier&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>useColors</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;../../../../hooks/useColors&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>CurveTrackMesh</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;../../../../components/curve/CurveTrackMesh&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>DragControlPoints</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;../../../../components/curve/DragControlPoints&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Ground</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;../../../../components/Ground&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>EditorScene</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;../../../../components/scenes/EditorScene&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>TrainWithPhysics</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;../../../../components/TrainWithPhysics&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>CurveOrientationDemoScene</span> <span style=color:#f92672>=</span> () <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>colors</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>useColors</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> [<span style=color:#a6e22e>points</span>, <span style=color:#a6e22e>setPoints</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>useState</span>([
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Vector3</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Vector3</span>(<span style=color:#ae81ff>12</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>0</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Vector3</span>(<span style=color:#ae81ff>12</span>, <span style=color:#ae81ff>15</span>, <span style=color:#ae81ff>0</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Vector3</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>0</span>),
</span></span><span style=display:flex><span>  ]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>curve</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>useMemo</span>(() <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>bezierSplineCurve</span>(<span style=color:#a6e22e>points</span>), [<span style=color:#a6e22e>points</span>]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> (
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>EditorScene</span>&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>group</span> <span style=color:#a6e22e>position</span><span style=color:#f92672>=</span>{[<span style=color:#f92672>-</span><span style=color:#ae81ff>11</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>5</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>10</span>]}&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>Line</span>
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>points</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>points</span>}
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>color</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>colors</span>.<span style=color:#a6e22e>highlight</span>}
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>segments</span><span style=color:#f92672>=</span>{<span style=color:#66d9ef>true</span>}
</span></span><span style=display:flex><span>        /&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>DragControlPoints</span> <span style=color:#a6e22e>points</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>points</span>} <span style=color:#a6e22e>setPoints</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>setPoints</span>} /&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>CurveTrackMesh</span> <span style=color:#a6e22e>curve</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>curve</span>} /&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>TrainWithPhysics</span> <span style=color:#a6e22e>curve</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>curve</span>} <span style=color:#a6e22e>init</span><span style=color:#f92672>=</span>{{ <span style=color:#a6e22e>velocity</span>: <span style=color:#66d9ef>17</span> }} /&gt;
</span></span><span style=display:flex><span>      &lt;/<span style=color:#f92672>group</span>&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>group</span> <span style=color:#a6e22e>position</span><span style=color:#f92672>=</span>{[<span style=color:#ae81ff>0</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>0</span>]}&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>Ground</span> /&gt;
</span></span><span style=display:flex><span>      &lt;/<span style=color:#f92672>group</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>EditorScene</span>&gt;
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>};
</span></span></code></pre></div></div></article><hr><div class=post-info><p><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg>
<span class=tag><a href=https://ercanakyuerek.de/tags/writing-a-roller-coaster-simulation/>writing a roller coaster simulation</a></span></p><p><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>
1450 Words</p><p><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
2026-01-04 13:30</p></div><hr><div class=sharing-buttons><a class=resp-sharing-button__link href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fercanakyuerek.de%2fposts%2fwriting-a-roller-coaster-simulation%2fcurve-orientation%2f" target=_blank rel=noopener aria-label title="Share on facebook"><div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 00-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 011-1h3z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://twitter.com/intent/tweet/?url=https%3a%2f%2fercanakyuerek.de%2fposts%2fwriting-a-roller-coaster-simulation%2fcurve-orientation%2f" target=_blank rel=noopener aria-label title="Share on twitter"><div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://www.tumblr.com/widgets/share/tool?posttype=link&amp;title=Curve%20orientation&amp;caption=Curve%20orientation&amp;canonicalUrl=https%3a%2f%2fercanakyuerek.de%2fposts%2fwriting-a-roller-coaster-simulation%2fcurve-orientation%2f" target=_blank rel=noopener aria-label title="Share on tumblr"><div class="resp-sharing-button resp-sharing-button--tumblr resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.563 24c-5.093.0-7.031-3.756-7.031-6.411V9.747H5.116V6.648c3.63-1.313 4.512-4.596 4.71-6.469C9.84.051 9.941.0 9.999.0h3.517v6.114h4.801v3.633h-4.82v7.47c.016 1.001.375 2.371 2.207 2.371h.09c.631-.02 1.486-.205 1.936-.419l1.156 3.425c-.436.636-2.4 1.374-4.156 1.404h-.178l.011.002z"/></svg></div></div></a><a class=resp-sharing-button__link href="mailto:?subject=Curve%20orientation&amp;body=https%3a%2f%2fercanakyuerek.de%2fposts%2fwriting-a-roller-coaster-simulation%2fcurve-orientation%2f" target=_self rel=noopener aria-label title="Share via email"><div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg></div></div></a><a class=resp-sharing-button__link href="https://pinterest.com/pin/create/button/?url=https%3a%2f%2fercanakyuerek.de%2fposts%2fwriting-a-roller-coaster-simulation%2fcurve-orientation%2f&amp;media=https%3a%2f%2fercanakyuerek.de%2fposts%2fwriting-a-roller-coaster-simulation%2fcurve-orientation%2f;description=Curve%20orientation" target=_blank rel=noopener aria-label title="Share on pinterest"><div class="resp-sharing-button resp-sharing-button--pinterest resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12.017.0C5.396.0.029 5.367.029 11.987c0 5.079 3.158 9.417 7.618 11.162-.105-.949-.199-2.403.041-3.439.219-.937 1.406-5.957 1.406-5.957s-.359-.72-.359-1.781c0-1.663.967-2.911 2.168-2.911 1.024.0 1.518.769 1.518 1.688.0 1.029-.653 2.567-.992 3.992-.285 1.193.6 2.165 1.775 2.165 2.128.0 3.768-2.245 3.768-5.487.0-2.861-2.063-4.869-5.008-4.869-3.41.0-5.409 2.562-5.409 5.199.0 1.033.394 2.143.889 2.741.099.12.112.225.085.345-.09.375-.293 1.199-.334 1.363-.053.225-.172.271-.401.165-1.495-.69-2.433-2.878-2.433-4.646.0-3.776 2.748-7.252 7.92-7.252 4.158.0 7.392 2.967 7.392 6.923.0 4.135-2.607 7.462-6.233 7.462-1.214.0-2.354-.629-2.758-1.379l-.749 2.848c-.269 1.045-1.004 2.352-1.498 3.146 1.123.345 2.306.535 3.55.535 6.607.0 11.985-5.365 11.985-11.987C23.97 5.39 18.592.026 11.985.026L12.017.0z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fercanakyuerek.de%2fposts%2fwriting-a-roller-coaster-simulation%2fcurve-orientation%2f&amp;title=Curve%20orientation&amp;summary=Curve%20orientation&amp;source=https%3a%2f%2fercanakyuerek.de%2fposts%2fwriting-a-roller-coaster-simulation%2fcurve-orientation%2f" target=_blank rel=noopener aria-label title="Share on linkedin"><div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg></div></div></a><a class=resp-sharing-button__link href="https://reddit.com/submit/?url=https%3a%2f%2fercanakyuerek.de%2fposts%2fwriting-a-roller-coaster-simulation%2fcurve-orientation%2f&amp;resubmit=true&amp;title=Curve%20orientation" target=_blank rel=noopener aria-label title="Share on reddit"><div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12 0A12 12 0 000 12a12 12 0 0012 12 12 12 0 0012-12A12 12 0 0012 0zm5.01 4.744c.688.0 1.25.561 1.25 1.249a1.25 1.25.0 01-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968.0 1.754.786 1.754 1.754.0.716-.435 1.333-1.01 1.614a3.111 3.111.0 01.042.52c0 2.694-3.13 4.87-7.004 4.87s-7.004-2.176-7.004-4.87c0-.183.015-.366.043-.534A1.748 1.748.0 014.028 12c0-.968.786-1.754 1.754-1.754.463.0.898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342.0 01.14-.197.35.35.0 01.238-.042l2.906.617a1.214 1.214.0 011.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687.0 1.248-.561 1.248-1.249S9.937 12 9.249 12zm5.5.0c-.687.0-1.248.561-1.248 1.25.0.687.561 1.248 1.249 1.248S16 13.937 16 13.249c0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327.0 00-.231.094.33.33.0 000 .463c.842.842 2.484.913 2.961.913s2.105-.056 2.961-.913a.361.361.0 00.029-.463.33.33.0 00-.464.0c-.547.533-1.684.73-2.512.73-.828.0-1.979-.196-2.512-.73a.326.326.0 00-.232-.095z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://www.xing.com/app/user?op=share;url=https%3a%2f%2fercanakyuerek.de%2fposts%2fwriting-a-roller-coaster-simulation%2fcurve-orientation%2f;title=Curve%20orientation" target=_blank rel=noopener aria-label title="Share on xing"><div class="resp-sharing-button resp-sharing-button--xing resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M18.188.0c-.517.0-.741.325-.927.66.0.0-7.455 13.224-7.702 13.657.015.024 4.919 9.023 4.919 9.023.17.308.436.66.967.66h3.454c.211.0.375-.078.463-.22.089-.151.089-.346-.009-.536l-4.879-8.916c-.004-.006-.004-.016.0-.022L22.139.756c.095-.191.097-.387.006-.535C22.056.078 21.894.0 21.686.0h-3.498zM3.648 4.74c-.211.0-.385.074-.473.216-.09.149-.078.339.02.531l2.34 4.05c.004.01.004.016.0.021L1.86 16.051c-.099.188-.093.381.0.529.085.142.239.234.45.234h3.461c.518.0.766-.348.945-.667l3.734-6.609-2.378-4.155c-.172-.315-.434-.659-.962-.659H3.648v.016z"/></svg></div></div></a><a class=resp-sharing-button__link href="whatsapp://send?text=Curve%20orientation%20https%3a%2f%2fercanakyuerek.de%2fposts%2fwriting-a-roller-coaster-simulation%2fcurve-orientation%2f" target=_blank rel=noopener aria-label title="Share on whatsapp"><div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198.0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479.0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87.0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86.0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64.0 5.122 1.03 6.988 2.898a9.825 9.825.0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815.0 0012.05.0C5.495.0.16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882.0 005.683 1.448h.005c6.554.0 11.89-5.335 11.893-11.893a11.821 11.821.0 00-3.48-8.413z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fercanakyuerek.de%2fposts%2fwriting-a-roller-coaster-simulation%2fcurve-orientation%2f&amp;t=Curve%20orientation" target=_blank rel=noopener aria-label title="Share on hacker news"><div class="resp-sharing-button resp-sharing-button--hackernews resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M0 24V0h24v24H0zM6.951 5.896l4.112 7.708v5.064h1.583v-4.972l4.148-7.799h-1.749l-2.457 4.875c-.372.745-.688 1.434-.688 1.434s-.297-.708-.651-1.434L8.831 5.896h-1.88z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://telegram.me/share/url?text=Curve%20orientation&amp;url=https%3a%2f%2fercanakyuerek.de%2fposts%2fwriting-a-roller-coaster-simulation%2fcurve-orientation%2f" target=_blank rel=noopener aria-label title="Share on telegram"><div class="resp-sharing-button resp-sharing-button--telegram resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg></div></div></a></div><div class=pagination><div class=pagination__buttons><span class="button previous"><a href=https://ercanakyuerek.de/posts/writing-a-roller-coaster-simulation/bezier-curve/><span class=button__icon>←</span>
<span class=button__text>Bézier curve</span>
</a></span><span class="button next"><a href=https://ercanakyuerek.de/posts/roller-coaster-simulation/nurbs-roll-physics-in-action/><span class=button__text>NURBS, Roll, Physics in Action</span>
<span class=button__icon>→</span></a></span></div></div></main></div><footer class=footer></footer></div><script type=text/javascript src=/bundle.min.257531934bfbdf8527f52eab4b38eb8211337125b54dae74132499837c006508dae0d544e859d909af1be266d147861c1c1e688de0f7d2cc2f258de78a9b8a6a.js integrity="sha512-JXUxk0v734Un9S6rSzjrghEzcSW1Ta50EySZg3wAZQja4NVE6FnZCa8b4mbRR4YcHB5ojeD30swvJY3nipuKag=="></script></body></html>