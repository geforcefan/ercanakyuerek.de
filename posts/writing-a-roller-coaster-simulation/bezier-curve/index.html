<!doctype html><html lang=en><head><meta charset=UTF-8><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content><meta name=description content=" An interactive example of a BÃ©zier curve, drag the controls around to see changes in shape So, now it is finally time to build an actual BÃ©zier curve instead of only linear segments.
I do not think BÃ©zier curves are particularly well suited for hand-building real roller coaster tracks. But they are simple to implement, easy to visualize, and most importantly, they finally give us real curvature instead of straight lines everywhere. And honestly, we have been staring at straight lines long enough.
"><meta name=keywords content="homepage,blog,writing a roller coaster simulation"><meta name=robots content="noodp"><meta name=theme-color content><link rel=canonical href=https://ercanakyuerek.de/posts/writing-a-roller-coaster-simulation/bezier-curve/><title>BÃ©zier curve :: Ercan AkyÃ¼rek</title><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css integrity="sha512-Cv93isQdFwaKBV+Z4X8kaVBYWHST58Xb/jVOcV9aRsGSArZsgAnFIhMpDoMDcFNoUtday1hdjn0nGp3+KZyyFw==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=/main.7dfa54b11346fdc488c38b6a39e84bcc4df388aa02986d48d0d12e6ec8bc1018.css integrity="sha256-ffpUsRNG/cSIw4tqOehLzE3ziKoCmG1I0NEubsi8EBg="><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color><link rel="shortcut icon" href=/favicon.ico><meta name=msapplication-TileColor content><meta itemprop=name content="BÃ©zier curve"><meta itemprop=description content="An interactive example of a BÃ©zier curve, drag the controls around to see changes in shape So, now it is finally time to build an actual BÃ©zier curve instead of only linear segments.
I do not think BÃ©zier curves are particularly well suited for hand-building real roller coaster tracks. But they are simple to implement, easy to visualize, and most importantly, they finally give us real curvature instead of straight lines everywhere. And honestly, we have been staring at straight lines long enough."><meta itemprop=datePublished content="2025-12-25T14:30:00+01:00"><meta itemprop=dateModified content="2025-12-25T14:30:00+01:00"><meta itemprop=wordCount content="2038"><meta itemprop=keywords content="Writing a Roller Coaster Simulation"><meta name=twitter:card content="summary"><meta name=twitter:title content="BÃ©zier curve"><meta name=twitter:description content="An interactive example of a BÃ©zier curve, drag the controls around to see changes in shape So, now it is finally time to build an actual BÃ©zier curve instead of only linear segments.
I do not think BÃ©zier curves are particularly well suited for hand-building real roller coaster tracks. But they are simple to implement, easy to visualize, and most importantly, they finally give us real curvature instead of straight lines everywhere. And honestly, we have been staring at straight lines long enough."><meta property="og:url" content="https://ercanakyuerek.de/posts/writing-a-roller-coaster-simulation/bezier-curve/"><meta property="og:site_name" content="Ercan AkyÃ¼rek"><meta property="og:title" content="BÃ©zier curve"><meta property="og:description" content="An interactive example of a BÃ©zier curve, drag the controls around to see changes in shape So, now it is finally time to build an actual BÃ©zier curve instead of only linear segments.
I do not think BÃ©zier curves are particularly well suited for hand-building real roller coaster tracks. But they are simple to implement, easy to visualize, and most importantly, they finally give us real curvature instead of straight lines everywhere. And honestly, we have been staring at straight lines long enough."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-12-25T14:30:00+01:00"><meta property="article:modified_time" content="2025-12-25T14:30:00+01:00"><meta property="article:tag" content="Writing a Roller Coaster Simulation"><meta property="article:published_time" content="2025-12-25 14:30:00 +0100 +0100"><script async src="https://www.googletagmanager.com/gtag/js?id=G-WCX2MRFT7Z"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-WCX2MRFT7Z")}</script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js></script><script>MathJax={tex:{displayMath:[["\\[","\\]"],["$$","$$"]],inlineMath:[["\\(","\\)"]]},loader:{load:["ui/safe"]}}</script></head><body><div class=container><header class=header><span class=header__inner><a href=/ style=text-decoration:none><div class=logo><span class=logo__mark>></span>
<span class=logo__text>ercanakyuerek.de</span>
<span class=logo__cursor></span></div></a><span class=header__right><nav class=menu><ul class=menu__inner><li><a href=/about>About me</a></li><li><a href=/posts>Posts</a></li></ul></nav><span class=menu-trigger><svg viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span></span></span></header><div class=content><main class=post><div class=post-info><p><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
10 minutes</p></div><article><h1 class=post-title><a href=https://ercanakyuerek.de/posts/writing-a-roller-coaster-simulation/bezier-curve/>BÃ©zier curve</a></h1><div class=post-content><div class="embedded float-right"><iframe id=react-root-699b2f842122afc553f80676bdee5970 width=225px height=285px class=frame></iframe><div class=description style=width:225px>An interactive example of a BÃ©zier curve, drag the controls around to see changes in shape</div><script>document.getElementById("react-root-699b2f842122afc553f80676bdee5970").srcdoc=`
    <!DOCTYPE html>
    <html lang="en" data-theme="dark">
      <head>
          <base href="${location.origin}/">
      </head>
        <body class="content-component">
        <div id="root" class="full-screen"></div>
        <script type="module">
          import { renderContentComponentByPath } from '/scripts/render-content-component.js';
          renderContentComponentByPath('root', './posts/writing-a-roller-coaster-simulation/bezier-curve/BezierCurveExampleScene.tsx');
        <\/script>
      </body>
    </html>
  `</script></div><p>So, now it is finally time to build an actual <strong>BÃ©zier curve</strong> instead
of only linear segments.</p><p>I do not think BÃ©zier curves are particularly well suited for
hand-building real roller coaster tracks. But they are simple to
implement, easy to visualize, and most importantly, they finally give
us <em>real curvature</em> instead of straight lines everywhere. And
honestly, we have been staring at straight lines long enough.</p><p>The nice part is that we already did the hard work earlier. Since we
introduced an agnostic way to describe curves using <strong>curve nodes</strong>,
all we need to do now is generate nodes that follow a BÃ©zier curve and
feed them into the simulation.</p><p>The physics simulation does not care where the shape comes from. It
does not know whether the curve is <strong>linear</strong>, <strong>BÃ©zier</strong>, <strong>NURBS</strong>,
<strong>FVD</strong>, or built from <strong>geometric shapes</strong>. It really does not care.
It just consumes curve nodes and keeps going. That was the whole point
of the abstraction.</p><p>This time, I will first show you a demo with a BÃ©zier curve, just to
spoil the ending a bit:</p><div class=embedded><iframe id=react-root-d96a5f8efe94ad4a8966ea8217d3c1cc width=100% height=480px class=frame></iframe>
<script>document.getElementById("react-root-d96a5f8efe94ad4a8966ea8217d3c1cc").srcdoc=`
    <!DOCTYPE html>
    <html lang="en" data-theme="dark">
      <head>
          <base href="${location.origin}/">
      </head>
        <body class="content-component">
        <div id="root" class="full-screen"></div>
        <script type="module">
          import { renderContentComponentByPath } from '/scripts/render-content-component.js';
          renderContentComponentByPath('root', './posts/writing-a-roller-coaster-simulation/bezier-curve/BezierCurveDemoScene.tsx');
        <\/script>
      </body>
    </html>
  `</script></div><h1 id=multiple-algorithms>Multiple algorithms</h1><p>A BÃ©zier curve can be evaluated in different ways. In practice, there
are multiple algorithms to compute points on the curve.</p><p>A very common choice is the <strong>de Casteljau</strong> algorithm. It is known
for its excellent numerical stability, but more importantly for us, it
is much easier to reason about. You can almost see the curve being
constructed step by step.</p><p>There are other options. Evaluating a BÃ©zier curve via <strong>Bernstein
polynomials</strong> is usually a bit faster and better suited when you want
to evaluate many points per frame. The tradeoff is slightly worse
numerical stability and, more importantly here, a less intuitive
mental model.</p><p>We choose <strong>de Casteljau</strong> on purpose. Not because it is the fastest
option, but because it makes it much clearer how a BÃ©zier curve is
actually constructed. For readability and understanding, this matters
more right now than raw performance. We can always optimize later,
once the idea is clear.</p><blockquote><p><strong>Important:</strong> I will <strong>not</strong> go deep into the theory of BÃ©zier
curves, NURBS, or splines in general. That topic is a rabbit hole
with no clear exit. Seriously. You will run into C0, C1, and C2
continuity, knot vectors, basis functions, and many strong opinions.</p><p>If you want to dive into that world, go for it. It is interesting,
but also confusing in equal parts. We will eventually implement
NURBS in this series as well, but without getting lost in the math.
For now, we keep things simple and practical. Your future self will
thank you.</p></blockquote><h1 id=bÃ©zier-evaluation-via-de-casteljau>BÃ©zier evaluation via de Casteljau</h1><p>I will explain very quickly how the <strong>de Casteljau</strong> algorithm works.</p><p>Assume we have <strong>4 control points</strong> and we want to know the
<strong>position</strong> for a parameter <code>t</code> in the range <code>[0, 1]</code>. What we
actually do is nothing more than repeated <strong>linear interpolation</strong>.</p><div class="embedded float-right"><iframe id=react-root-03d31a030927ffb1d07697579c382937 width=355px height=560px class=frame></iframe><div class=description style=width:355px>Each animation loop shows one iteration of linear interpolations in the de Casteljau algorithm. After all three iterations described in the article, the BÃ©zier curve is drawn.</div><script>document.getElementById("react-root-03d31a030927ffb1d07697579c382937").srcdoc=`
    <!DOCTYPE html>
    <html lang="en" data-theme="dark">
      <head>
          <base href="${location.origin}/">
      </head>
        <body class="content-component">
        <div id="root" class="full-screen"></div>
        <script type="module">
          import { renderContentComponentByPath } from '/scripts/render-content-component.js';
          renderContentComponentByPath('root', './posts/writing-a-roller-coaster-simulation/bezier-curve/DeCasteljauVisualizationScene.tsx');
        <\/script>
      </body>
    </html>
  `</script></div><p>First, we interpolate between the control points:</p><ul><li><code>a</code> = interpolate between <code>p0</code> and <code>p1</code></li><li><code>b</code> = interpolate between <code>p1</code> and <code>p2</code></li><li><code>c</code> = interpolate between <code>p2</code> and <code>p3</code></li></ul><p>At this point, we have three new points lying on those straight lines.</p><p>Next, we connect these points. What happens? We now get two new
straight lines, called <code>d</code> and <code>e</code>. And yes, we interpolate again:</p><ul><li><code>d</code> = interpolate between <code>a</code> and <code>b</code></li><li><code>e</code> = interpolate between <code>b</code> and <code>c</code></li></ul><p>Now we are left with two points. We connect them once more, which
gives us a new line <code>f</code>, and interpolate again:</p><ul><li><code>f</code> = interpolate between <code>d</code> and <code>e</code></li></ul><p>Now there is only <strong>one point left</strong> and nothing left to connect. That
point is what we return. It is the evaluated position on the BÃ©zier
curve.</p><p>So in the end, the algorithm is really just linear interpolation over
and over again until only a single point remains.</p><p>In code, this would look like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>a</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>points</span>[<span style=color:#ae81ff>0</span>].<span style=color:#a6e22e>clone</span>().<span style=color:#a6e22e>lerp</span>(<span style=color:#a6e22e>points</span>[<span style=color:#ae81ff>1</span>], <span style=color:#a6e22e>t</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>b</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>points</span>[<span style=color:#ae81ff>1</span>].<span style=color:#a6e22e>clone</span>().<span style=color:#a6e22e>lerp</span>(<span style=color:#a6e22e>points</span>[<span style=color:#ae81ff>2</span>], <span style=color:#a6e22e>t</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>c</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>points</span>[<span style=color:#ae81ff>2</span>].<span style=color:#a6e22e>clone</span>().<span style=color:#a6e22e>lerp</span>(<span style=color:#a6e22e>points</span>[<span style=color:#ae81ff>3</span>], <span style=color:#a6e22e>t</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>d</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>a</span>.<span style=color:#a6e22e>lerp</span>(<span style=color:#a6e22e>b</span>, <span style=color:#a6e22e>t</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>e</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>b</span>.<span style=color:#a6e22e>lerp</span>(<span style=color:#a6e22e>c</span>, <span style=color:#a6e22e>t</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>f</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>d</span>.<span style=color:#a6e22e>lerp</span>(<span style=color:#a6e22e>e</span>, <span style=color:#a6e22e>t</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>return</span> <span style=color:#a6e22e>f</span>;
</span></span></code></pre></div><p>As you can see, the function itself is just a bunch of linear
interpolations chained together. Nothing fancy.</p><p>Of course, this version is limited to exactly <strong>4 control points</strong>. If
we had <strong>3 control points</strong>, the exact same logic would apply. Instead
of three lines <code>a</code>, <code>b</code>, and <code>c</code>, we would only have two lines, <code>a</code>
and <code>b</code>, and in the next iteration we would simply interpolate between
those two. Same idea, fewer steps.</p><p>So instead of writing out every single <code>lerp</code> by hand for a fixed
number of control points, we can just use loops and make the algorithm
work for <strong>any number of control points</strong>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>p</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>points</span>.<span style=color:#a6e22e>map</span>((<span style=color:#a6e22e>v</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>v</span>.<span style=color:#a6e22e>clone</span>());
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>k</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>points</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>; <span style=color:#a6e22e>k</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>k</span><span style=color:#f92672>--</span>) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>k</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>p</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>lerp</span>(<span style=color:#a6e22e>p</span>[<span style=color:#a6e22e>i</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>], <span style=color:#a6e22e>t</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><blockquote><p><strong>Note</strong>: In practice, it usually makes sense to stop at <strong>four</strong>
control points, because everything beyond that tends to get unstable
pretty quickly. But the function itself does not limit stupidity.
That part is still up to us ðŸ™‚</p></blockquote><p>So we end up with a general version that works for any number of
control points. Add a small guard at the beginning and we are ready to
use it:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>deCasteljau</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>points</span>: <span style=color:#66d9ef>Vector3</span>[], <span style=color:#a6e22e>t</span>: <span style=color:#66d9ef>number</span>) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>points</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> Error(<span style=color:#e6db74>`Expected control points, got </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>points</span>.<span style=color:#a6e22e>length</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>p</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>points</span>.<span style=color:#a6e22e>map</span>((<span style=color:#a6e22e>v</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>v</span>.<span style=color:#a6e22e>clone</span>());
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>k</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>points</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>; <span style=color:#a6e22e>k</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>k</span><span style=color:#f92672>--</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>k</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>p</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>lerp</span>(<span style=color:#a6e22e>p</span>[<span style=color:#a6e22e>i</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>], <span style=color:#a6e22e>t</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>p</span>[<span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><h2 id=how-many-curve-nodes-do-we-need>How many curve nodes do we need?</h2><p>Now that we can evaluate a BÃ©zier curve for a parameter <code>t</code> in the
range <code>[0, 1]</code>, the next question is: how many <strong>curve nodes</strong> do we
actually want to generate along that curve?</p><p>More nodes mean better precision. Fewer nodes mean better performance.
We do not need perfect precision here, so we need to find a reasonable
<strong>sweet spot</strong>.</p><div class="embedded float-right"><iframe id=react-root-c975d2def19f5c67b9cb927ed1913c0b width=355px height=485px class=frame></iframe><div class=description style=width:355px>Interactive visualization of curve length estimation using uniformly sampled points. Try different sample counts and BÃ©zier shapes to see when the estimate becomes good enough. This is how I settled on 8 points as a reasonable sweet spot.</div><script>document.getElementById("react-root-c975d2def19f5c67b9cb927ed1913c0b").srcdoc=`
    <!DOCTYPE html>
    <html lang="en" data-theme="dark">
      <head>
          <base href="${location.origin}/">
      </head>
        <body class="content-component">
        <div id="root" class="full-screen"></div>
        <script type="module">
          import { renderContentComponentByPath } from '/scripts/render-content-component.js';
          renderContentComponentByPath('root', './posts/writing-a-roller-coaster-simulation/bezier-curve/EstimateLengthScene.tsx');
        <\/script>
      </body>
    </html>
  `</script></div><p>In practice, this is what I usually do:</p><ul><li>First, estimate the arc length of the BÃ©zier curve by uniformly
evaluating a small number of points on it. I normally pick <strong>8
points</strong> and sum up the distances between them.</li><li>Then, use this estimated length to compute the number of curve nodes
by multiplying it with a <strong>resolution</strong> value. I usually use
something like <code>20</code>.</li><li><strong>Example</strong>: a roughly <strong>20 meter</strong> long curve multiplied by a
resolution of <code>20</code> gives us <strong>400 nodes</strong>.</li><li>We then evaluate the BÃ©zier curve at those 400 positions and
construct curve nodes from them.</li><li>It will make sense to clamp the number of nodes in the <strong>editor</strong> in
the future, where <strong>performance matters while dragging control
points around</strong>. In the simulation, this is much less critical.</li></ul><p>To make this easier, we start with a small helper that lets us
<strong>uniformly sample</strong> a range with a given resolution. It gives us both
the actual value and a normalized<code>t</code> in <code>[0, 1]</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>uniformSample</span> <span style=color:#f92672>=</span> (
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>from</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>number</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>to</span>: <span style=color:#66d9ef>number</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>resolution</span>: <span style=color:#66d9ef>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>20</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fn</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>at</span>: <span style=color:#66d9ef>number</span>, <span style=color:#a6e22e>t</span>: <span style=color:#66d9ef>number</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#66d9ef>void</span>,
</span></span><span style=display:flex><span>) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>length</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>to</span> <span style=color:#f92672>-</span> <span style=color:#66d9ef>from</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>numberOfNodes</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>max</span>(Math.<span style=color:#a6e22e>floor</span>(<span style=color:#a6e22e>length</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>resolution</span>), <span style=color:#ae81ff>2</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>numberOfNodes</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>t</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>/</span> (<span style=color:#a6e22e>numberOfNodes</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>at</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>from</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>t</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>length</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>fn</span>(<span style=color:#a6e22e>at</span>, <span style=color:#a6e22e>t</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><p>If this feels a bit abstract, here is a concrete example.</p><p>Assume we want to sample from <code>1</code> to <code>6</code> with a resolution of <code>1</code>.
That means we will get <strong>5 evenly distributed values</strong>:</p><ul><li>actual values: <code>[1, 2.25, 3.5, 4.75, 6]</code></li><li>normalized values: <code>[0, 0.25, 0.5, 0.75, 1]</code></li></ul><h2 id=estimating-the-bÃ©zier-curve-length>Estimating the BÃ©zier curve length</h2><p>Now that we have <code>uniformSample</code>, estimating the curve length is
straightforward.</p><p>We simply pick <strong>8 evenly distributed values</strong> in the range <code>[0, 8]</code>
and evaluate the BÃ©zier curve at those normalized values:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>positions</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>uniformSampleMap</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>8</span>, <span style=color:#ae81ff>1</span>, (<span style=color:#a6e22e>at</span>, <span style=color:#a6e22e>t</span>) <span style=color:#f92672>=&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>deCasteljau</span>(<span style=color:#a6e22e>points</span>, <span style=color:#a6e22e>t</span>),
</span></span><span style=display:flex><span>);
</span></span></code></pre></div><p>At this point, <code>positions</code> contains 8 points along the BÃ©zier curve.</p><p>From here, it is extremely easy to iterate over these points and sum
up the distances between positions to get an <strong>estimated total arc
length</strong>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>return</span> <span style=color:#a6e22e>positions</span>
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>slice</span>(<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>reduce</span>(
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>arcLength</span>, <span style=color:#a6e22e>position</span>, <span style=color:#a6e22e>i</span>) <span style=color:#f92672>=&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>arcLength</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>position</span>.<span style=color:#a6e22e>distanceTo</span>(<span style=color:#a6e22e>positions</span>[<span style=color:#a6e22e>i</span>]),
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>  );
</span></span></code></pre></div><p>Now we end up with this estimate function:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>estimateTotalArcLength</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>points</span>: <span style=color:#66d9ef>Vector3</span>[]) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>positions</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>uniformSampleMap</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>8</span>, <span style=color:#ae81ff>1</span>, (<span style=color:#a6e22e>at</span>, <span style=color:#a6e22e>t</span>) <span style=color:#f92672>=&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>deCasteljau</span>(<span style=color:#a6e22e>points</span>, <span style=color:#a6e22e>t</span>),
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>positions</span>
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>slice</span>(<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>reduce</span>(
</span></span><span style=display:flex><span>      (<span style=color:#a6e22e>arcLength</span>, <span style=color:#a6e22e>position</span>, <span style=color:#a6e22e>i</span>) <span style=color:#f92672>=&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>arcLength</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>position</span>.<span style=color:#a6e22e>distanceTo</span>(<span style=color:#a6e22e>positions</span>[<span style=color:#a6e22e>i</span>]),
</span></span><span style=display:flex><span>      <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>    );
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><p>Here is the <code>uniformSampleMap</code> function. It is a small convenience
helper that wraps <code>uniformSample</code> and makes mapping the result easier,
instead of having to do it manually each time. It will show up here
and there in later chapters.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>uniformSampleMap</span> <span style=color:#f92672>=</span> &lt;<span style=color:#f92672>T</span>&gt;(
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>from</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>number</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>to</span>: <span style=color:#66d9ef>number</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>resolution</span>: <span style=color:#66d9ef>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>20</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>mapFn</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>at</span>: <span style=color:#66d9ef>number</span>, <span style=color:#a6e22e>t</span>: <span style=color:#66d9ef>number</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>T</span>,
</span></span><span style=display:flex><span>) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>out</span>: <span style=color:#66d9ef>T</span>[] <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>uniformSample</span>(<span style=color:#66d9ef>from</span>, <span style=color:#a6e22e>to</span>, <span style=color:#a6e22e>resolution</span>, (<span style=color:#a6e22e>at</span>, <span style=color:#a6e22e>t</span>) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>mapFn</span>(<span style=color:#a6e22e>at</span>, <span style=color:#a6e22e>t</span>));
</span></span><span style=display:flex><span>  });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>out</span>;
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><h1 id=constructing-a-bÃ©zier-curve>Constructing a BÃ©zier curve</h1><p>This part is almost stupidly simple, so I will just paste the code and
explain it briefly.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>bezierSplineCurve</span> <span style=color:#f92672>=</span> (
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>points</span>: <span style=color:#66d9ef>Vector3</span>[],
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>resolution</span>: <span style=color:#66d9ef>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>20</span>,
</span></span><span style=display:flex><span>) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>positions</span>: <span style=color:#66d9ef>Vector3</span>[] <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>uniformSample</span>(<span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>estimateLength</span>(<span style=color:#a6e22e>points</span>), <span style=color:#a6e22e>resolution</span>, (<span style=color:#a6e22e>at</span>, <span style=color:#a6e22e>t</span>) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>positions</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>deCasteljau</span>(<span style=color:#a6e22e>points</span>, <span style=color:#a6e22e>t</span>));
</span></span><span style=display:flex><span>  });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>fromPoints</span>(<span style=color:#a6e22e>positions</span>);
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><blockquote><p><strong>Note:</strong> In the repository, <code>bezierSplineCurve</code> has a slightly
different implementation that calls utility functions for proper
curve orientation calculation. Do not worry about this for now. We
will cover it in the next chapters.</p></blockquote><p>What happens here is straightforward:</p><ul><li>We sample from <code>0</code> to the <strong>estimated length</strong> of the BÃ©zier curve.</li><li>We use a default resolution of <code>20</code>.</li><li>For each sample, we evaluate the curve using the <strong>de Casteljau</strong>
algorithm with <code>t</code> in the range <code>[0, 1]</code>.</li><li>The resulting positions are then turned into a curve using
<code>fromPoints</code>, which we implemented earlier.</li></ul><p>There is nothing more going on here. We sample the curve, evaluate it,
and turn the result into curve nodes.</p><h2 id=whats-next>Whatâ€™s next?</h2><p><a href=https://ercanakyuerek.de/posts/writing-a-roller-coaster-simulation/curve-orientation/>In the next article</a>, we will eventually and finally fix our curve node
orientation problems and create a good <code>fromPoints</code> function that
calculates the orientation in a way that nothing breaks on looping or
slopes close to 90Â°.</p><p>Right now, our <code>fromPoints</code> is a temporary junk implementation with
hard transitions on the edges. That was fine while we only had linear
segments, but now we actually have curvature, so the problems are much
easier to see.</p><blockquote><p><strong>Note</strong>: In the demo, I already intentionally use the correct way
of inserting positions (by using <code>fromUniformSampledPositions</code>
instead of <code>fromPoints</code> from the last chapter) on the curve with
proper curve node orientation calculation, so the demo does not
jitter. Do not be confused by this. I am basically taking things a
bit ahead of time here.</p></blockquote><h1 id=demo-code>Demo code</h1><p>If you want to run the code locally, clone this
<a href=https://github.com/geforcefan/ercanakyuerek.de target=_blank>repository</a>,
run <code>npm install</code> and <code>npm run dev-scripts</code>,
then open this
<a href=http://localhost:3000/src/content/posts/writing-a-roller-coaster-simulation/bezier-curve/BezierCurveDemoScene.tsx target=_blank>link</a>
in your browser.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-tsx data-lang=tsx><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>React</span>, { <span style=color:#a6e22e>useMemo</span>, <span style=color:#a6e22e>useState</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;react&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Line</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@react-three/drei&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Vector3</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;three&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>bezierSplineCurve</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;../../../../maths/bezier&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>useColors</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;../../../../hooks/useColors&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>CurveTrackMesh</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;../../../../components/curve/CurveTrackMesh&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>DragControlPoints</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;../../../../components/curve/DragControlPoints&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Ground</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;../../../../components/Ground&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>EditorScene</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;../../../../components/scenes/EditorScene&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>TrainWithPhysics</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;../../../../components/TrainWithPhysics&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>BezierCurveDemoScene</span> <span style=color:#f92672>=</span> () <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>colors</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>useColors</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> [<span style=color:#a6e22e>points</span>, <span style=color:#a6e22e>setPoints</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>useState</span>([
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Vector3</span>(<span style=color:#f92672>-</span><span style=color:#ae81ff>11.3</span>, <span style=color:#ae81ff>3.9</span>, <span style=color:#ae81ff>0</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Vector3</span>(<span style=color:#f92672>-</span><span style=color:#ae81ff>6.6</span>, <span style=color:#ae81ff>2.7</span>, <span style=color:#ae81ff>0</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Vector3</span>(<span style=color:#f92672>-</span><span style=color:#ae81ff>5.8</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>3.8</span>, <span style=color:#ae81ff>0</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Vector3</span>(<span style=color:#ae81ff>0</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>2.4</span>, <span style=color:#ae81ff>0</span>),
</span></span><span style=display:flex><span>  ]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>curve</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>useMemo</span>(() <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>bezierSplineCurve</span>(<span style=color:#a6e22e>points</span>), [<span style=color:#a6e22e>points</span>]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> (
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>EditorScene</span>&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>Line</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>points</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>points</span>}
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>color</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>colors</span>.<span style=color:#a6e22e>highlight</span>}
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>segments</span><span style=color:#f92672>=</span>{<span style=color:#66d9ef>true</span>}
</span></span><span style=display:flex><span>      /&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>DragControlPoints</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>axisLock</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;z&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>points</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>points</span>}
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>setPoints</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>setPoints</span>}
</span></span><span style=display:flex><span>      /&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>CurveTrackMesh</span> <span style=color:#a6e22e>curve</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>curve</span>} /&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>TrainWithPhysics</span> <span style=color:#a6e22e>curve</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>curve</span>} /&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>Ground</span> <span style=color:#a6e22e>position</span><span style=color:#f92672>=</span>{[<span style=color:#ae81ff>0</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>0</span>]} /&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>EditorScene</span>&gt;
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>};
</span></span></code></pre></div></div></article><hr><div class=post-info><p><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg>
<span class=tag><a href=https://ercanakyuerek.de/tags/writing-a-roller-coaster-simulation/>writing a roller coaster simulation</a></span></p><p><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>
2038 Words</p><p><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
2025-12-25 13:30</p></div><hr><div class=sharing-buttons><a class=resp-sharing-button__link href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fercanakyuerek.de%2fposts%2fwriting-a-roller-coaster-simulation%2fbezier-curve%2f" target=_blank rel=noopener aria-label title="Share on facebook"><div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 00-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 011-1h3z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://twitter.com/intent/tweet/?url=https%3a%2f%2fercanakyuerek.de%2fposts%2fwriting-a-roller-coaster-simulation%2fbezier-curve%2f" target=_blank rel=noopener aria-label title="Share on twitter"><div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://www.tumblr.com/widgets/share/tool?posttype=link&amp;title=B%c3%a9zier%20curve&amp;caption=B%c3%a9zier%20curve&amp;canonicalUrl=https%3a%2f%2fercanakyuerek.de%2fposts%2fwriting-a-roller-coaster-simulation%2fbezier-curve%2f" target=_blank rel=noopener aria-label title="Share on tumblr"><div class="resp-sharing-button resp-sharing-button--tumblr resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.563 24c-5.093.0-7.031-3.756-7.031-6.411V9.747H5.116V6.648c3.63-1.313 4.512-4.596 4.71-6.469C9.84.051 9.941.0 9.999.0h3.517v6.114h4.801v3.633h-4.82v7.47c.016 1.001.375 2.371 2.207 2.371h.09c.631-.02 1.486-.205 1.936-.419l1.156 3.425c-.436.636-2.4 1.374-4.156 1.404h-.178l.011.002z"/></svg></div></div></a><a class=resp-sharing-button__link href="mailto:?subject=B%c3%a9zier%20curve&amp;body=https%3a%2f%2fercanakyuerek.de%2fposts%2fwriting-a-roller-coaster-simulation%2fbezier-curve%2f" target=_self rel=noopener aria-label title="Share via email"><div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg></div></div></a><a class=resp-sharing-button__link href="https://pinterest.com/pin/create/button/?url=https%3a%2f%2fercanakyuerek.de%2fposts%2fwriting-a-roller-coaster-simulation%2fbezier-curve%2f&amp;media=https%3a%2f%2fercanakyuerek.de%2fposts%2fwriting-a-roller-coaster-simulation%2fbezier-curve%2f;description=B%c3%a9zier%20curve" target=_blank rel=noopener aria-label title="Share on pinterest"><div class="resp-sharing-button resp-sharing-button--pinterest resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12.017.0C5.396.0.029 5.367.029 11.987c0 5.079 3.158 9.417 7.618 11.162-.105-.949-.199-2.403.041-3.439.219-.937 1.406-5.957 1.406-5.957s-.359-.72-.359-1.781c0-1.663.967-2.911 2.168-2.911 1.024.0 1.518.769 1.518 1.688.0 1.029-.653 2.567-.992 3.992-.285 1.193.6 2.165 1.775 2.165 2.128.0 3.768-2.245 3.768-5.487.0-2.861-2.063-4.869-5.008-4.869-3.41.0-5.409 2.562-5.409 5.199.0 1.033.394 2.143.889 2.741.099.12.112.225.085.345-.09.375-.293 1.199-.334 1.363-.053.225-.172.271-.401.165-1.495-.69-2.433-2.878-2.433-4.646.0-3.776 2.748-7.252 7.92-7.252 4.158.0 7.392 2.967 7.392 6.923.0 4.135-2.607 7.462-6.233 7.462-1.214.0-2.354-.629-2.758-1.379l-.749 2.848c-.269 1.045-1.004 2.352-1.498 3.146 1.123.345 2.306.535 3.55.535 6.607.0 11.985-5.365 11.985-11.987C23.97 5.39 18.592.026 11.985.026L12.017.0z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fercanakyuerek.de%2fposts%2fwriting-a-roller-coaster-simulation%2fbezier-curve%2f&amp;title=B%c3%a9zier%20curve&amp;summary=B%c3%a9zier%20curve&amp;source=https%3a%2f%2fercanakyuerek.de%2fposts%2fwriting-a-roller-coaster-simulation%2fbezier-curve%2f" target=_blank rel=noopener aria-label title="Share on linkedin"><div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg></div></div></a><a class=resp-sharing-button__link href="https://reddit.com/submit/?url=https%3a%2f%2fercanakyuerek.de%2fposts%2fwriting-a-roller-coaster-simulation%2fbezier-curve%2f&amp;resubmit=true&amp;title=B%c3%a9zier%20curve" target=_blank rel=noopener aria-label title="Share on reddit"><div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12 0A12 12 0 000 12a12 12 0 0012 12 12 12 0 0012-12A12 12 0 0012 0zm5.01 4.744c.688.0 1.25.561 1.25 1.249a1.25 1.25.0 01-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968.0 1.754.786 1.754 1.754.0.716-.435 1.333-1.01 1.614a3.111 3.111.0 01.042.52c0 2.694-3.13 4.87-7.004 4.87s-7.004-2.176-7.004-4.87c0-.183.015-.366.043-.534A1.748 1.748.0 014.028 12c0-.968.786-1.754 1.754-1.754.463.0.898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342.0 01.14-.197.35.35.0 01.238-.042l2.906.617a1.214 1.214.0 011.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687.0 1.248-.561 1.248-1.249S9.937 12 9.249 12zm5.5.0c-.687.0-1.248.561-1.248 1.25.0.687.561 1.248 1.249 1.248S16 13.937 16 13.249c0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327.0 00-.231.094.33.33.0 000 .463c.842.842 2.484.913 2.961.913s2.105-.056 2.961-.913a.361.361.0 00.029-.463.33.33.0 00-.464.0c-.547.533-1.684.73-2.512.73-.828.0-1.979-.196-2.512-.73a.326.326.0 00-.232-.095z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://www.xing.com/app/user?op=share;url=https%3a%2f%2fercanakyuerek.de%2fposts%2fwriting-a-roller-coaster-simulation%2fbezier-curve%2f;title=B%c3%a9zier%20curve" target=_blank rel=noopener aria-label title="Share on xing"><div class="resp-sharing-button resp-sharing-button--xing resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M18.188.0c-.517.0-.741.325-.927.66.0.0-7.455 13.224-7.702 13.657.015.024 4.919 9.023 4.919 9.023.17.308.436.66.967.66h3.454c.211.0.375-.078.463-.22.089-.151.089-.346-.009-.536l-4.879-8.916c-.004-.006-.004-.016.0-.022L22.139.756c.095-.191.097-.387.006-.535C22.056.078 21.894.0 21.686.0h-3.498zM3.648 4.74c-.211.0-.385.074-.473.216-.09.149-.078.339.02.531l2.34 4.05c.004.01.004.016.0.021L1.86 16.051c-.099.188-.093.381.0.529.085.142.239.234.45.234h3.461c.518.0.766-.348.945-.667l3.734-6.609-2.378-4.155c-.172-.315-.434-.659-.962-.659H3.648v.016z"/></svg></div></div></a><a class=resp-sharing-button__link href="whatsapp://send?text=B%c3%a9zier%20curve%20https%3a%2f%2fercanakyuerek.de%2fposts%2fwriting-a-roller-coaster-simulation%2fbezier-curve%2f" target=_blank rel=noopener aria-label title="Share on whatsapp"><div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198.0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479.0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87.0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86.0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64.0 5.122 1.03 6.988 2.898a9.825 9.825.0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815.0 0012.05.0C5.495.0.16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882.0 005.683 1.448h.005c6.554.0 11.89-5.335 11.893-11.893a11.821 11.821.0 00-3.48-8.413z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fercanakyuerek.de%2fposts%2fwriting-a-roller-coaster-simulation%2fbezier-curve%2f&amp;t=B%c3%a9zier%20curve" target=_blank rel=noopener aria-label title="Share on hacker news"><div class="resp-sharing-button resp-sharing-button--hackernews resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M0 24V0h24v24H0zM6.951 5.896l4.112 7.708v5.064h1.583v-4.972l4.148-7.799h-1.749l-2.457 4.875c-.372.745-.688 1.434-.688 1.434s-.297-.708-.651-1.434L8.831 5.896h-1.88z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://telegram.me/share/url?text=B%c3%a9zier%20curve&amp;url=https%3a%2f%2fercanakyuerek.de%2fposts%2fwriting-a-roller-coaster-simulation%2fbezier-curve%2f" target=_blank rel=noopener aria-label title="Share on telegram"><div class="resp-sharing-button resp-sharing-button--telegram resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg></div></div></a></div><div class=pagination><div class=pagination__buttons><span class="button previous"><a href=https://ercanakyuerek.de/posts/writing-a-roller-coaster-simulation/curve-nodes/><span class=button__icon>â†</span>
<span class=button__text>Curve Nodes</span>
</a></span><span class="button next"><a href=https://ercanakyuerek.de/posts/writing-a-roller-coaster-simulation/curve-orientation/><span class=button__text>Curve orientation</span>
<span class=button__icon>â†’</span></a></span></div></div></main></div><footer class=footer></footer></div><script type=text/javascript src=/bundle.min.257531934bfbdf8527f52eab4b38eb8211337125b54dae74132499837c006508dae0d544e859d909af1be266d147861c1c1e688de0f7d2cc2f258de78a9b8a6a.js integrity="sha512-JXUxk0v734Un9S6rSzjrghEzcSW1Ta50EySZg3wAZQja4NVE6FnZCa8b4mbRR4YcHB5ojeD30swvJY3nipuKag=="></script></body></html>